{"ast":null,"code":"export default {\n  name: \"SingIn\",\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      newUser: {},\n      integral: 10,\n      count: 0,\n      value: new Date(),\n      tableData: [],\n      drawer: false,\n      direction: 'rtl',\n      current: 6,\n      items: [6, 12, 30, 68, 98, 128, 328, 648]\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    clickItem(item) {\n      this.current = item;\n    },\n    handleClose(done) {\n      this.$confirm('确认关闭？').then(_ => {\n        done();\n      }).catch(_ => {});\n    },\n    load() {\n      // 获取用户信息\n      this.$request.get('user/select/' + this.user.id).then(res => {\n        this.newUser = res.data || {};\n      });\n      // 获取签到记录(30条)\n      this.$request.get('/records/selectAll', {\n        params: {\n          userId: this.user.id\n        }\n      }).then(res => {\n        this.tableData = res.data || [];\n      });\n      // 获取签到记录总数\n      this.$request.get('/signIn/selectCount/' + this.user.id).then(res => {\n        this.count = res.data || 0;\n      });\n    },\n    handleCheckIn() {\n      this.$request.post('/signIn/add', {\n        userId: this.user.id,\n        integral: this.integral\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success('签到成功');\n          this.$request.put('/user/updateIntegral2', {\n            id: this.user.id,\n            integral: this.integral\n          }).then(res => {\n            if (res.code === '200') {\n              this.$message.success('积分更新成功');\n              this.load();\n            } else {\n              this.$message.error('积分更新失败');\n            }\n          });\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n      this.load();\n    },\n    handlePay() {\n      this.$request.put('/user/updateIntegral', {\n        id: this.user.id,\n        integral: this.current\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success('充值成功');\n          this.load();\n        } else {\n          this.$message.error('充值失败');\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","user","JSON","parse","localStorage","getItem","newUser","integral","count","value","Date","tableData","drawer","direction","current","items","mounted","load","methods","clickItem","item","handleClose","done","$confirm","then","_","catch","$request","get","id","res","params","userId","handleCheckIn","post","code","$message","success","put","error","msg","handlePay"],"sources":["src/views/front/SignIn.vue"],"sourcesContent":["<template>\n  <div class=\"main-content\" style=\"width: 50%\">\n    <div class=\"card\" style=\"font-weight: bold;font-size: 28px;display: flex\">\n      <div style=\"margin-right: 80px\">现有积分：{{ newUser.integral }}</div>\n      <div>签到天数：{{ count }}</div>\n      <div style=\"flex: 1;text-align: right\"><!-- 添加签到按钮 -->\n        <el-button size=\"medium\" @click=\"handleCheckIn()\" type=\"primary\">签到</el-button>\n        <el-button size=\"medium\" @click=\"drawer = true\" type=\"success\">充值</el-button>\n      </div>\n    </div>\n    <div class=\"card\" style=\"margin-top: 10px\">\n      <div style=\"color: #999999\">最近30条记录</div>\n      <el-table\n          :data=\"tableData\"\n          style=\"width: 100%\">\n        <el-table-column\n            prop=\"type\"\n            label=\"方式\"\n            width=\"200\">\n        </el-table-column>\n        <el-table-column\n            prop=\"time\"\n            label=\"获取日期\"\n            width=\"200\">\n        </el-table-column>\n        <el-table-column\n            prop=\"integral\"\n            label=\"积分变动\"\n            width=\"200\">\n        </el-table-column>\n      </el-table>\n    </div>\n    <el-drawer\n        title=\"充值\"\n        :visible.sync=\"drawer\"\n        :direction=\"direction\"\n        :before-close=\"handleClose\">\n      <el-card shadow=\"never\" style=\"padding: 20px;\">\n        <div class=\"card\">\n          <el-row :gutter=\"10\">\n            <el-col :span=\"6\" v-for=\"item in items\" :key=\"item\">\n              <div class=\"charge-item\" :class=\"{ 'active': current === item }\" @click=\"clickItem(item)\">\n                ￥{{ item }}\n              </div>\n            </el-col>\n          </el-row>\n\n          <div style=\"margin-top: 20px;\">\n            <el-button type=\"primary\" size=\"medium\" @click=\"handlePay()\" style=\"background-color: #f94b4b;\">支 付</el-button>\n          </div>\n        </div>\n      </el-card>\n    </el-drawer>\n  </div>\n</template>\n<script>\nexport default {\n  name: \"SingIn\",\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      newUser: {},\n      integral: 10,\n      count: 0,\n      value: new Date(),\n      tableData: [],\n      drawer: false,\n      direction: 'rtl',\n      current: 6,\n      items: [6, 12, 30, 68, 98, 128, 328, 648]\n    };\n  },\n  mounted() {\n    this.load()\n  },\n  methods: {\n    clickItem(item) {\n      this.current = item\n    },\n    handleClose(done) {\n      this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {\n          });\n    },\n    load() {\n      // 获取用户信息\n      this.$request.get('user/select/' + this.user.id).then(res => {\n        this.newUser = res.data || {}\n      })\n      // 获取签到记录(30条)\n      this.$request.get('/records/selectAll', {\n        params: {\n          userId: this.user.id\n        }\n      }).then(res => {\n        this.tableData = res.data || []\n      })\n      // 获取签到记录总数\n      this.$request.get('/signIn/selectCount/' + this.user.id).then(res => {\n        this.count = res.data || 0\n      })\n    },\n    handleCheckIn() {\n      this.$request.post('/signIn/add', {\n        userId: this.user.id,\n        integral: this.integral\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success('签到成功')\n          this.$request.put('/user/updateIntegral2', {\n            id: this.user.id,\n            integral: this.integral\n          }).then(res => {\n            if (res.code === '200') {\n              this.$message.success('积分更新成功')\n              this.load()\n            } else {\n              this.$message.error('积分更新失败')\n            }\n          })\n        } else {\n          this.$message.error(res.msg)\n        }\n      })\n      this.load()\n    },\n    handlePay() {\n      this.$request.put('/user/updateIntegral', {\n        id: this.user.id,\n        integral: this.current\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success('充值成功')\n          this.load()\n        } else {\n          this.$message.error('充值失败')\n        }\n      })\n\n    }\n  },\n}\n\n</script>\n\n<style scoped>\n.charge-item {\n  border: 1px solid #ccc;\n  padding: 20px 0;\n  margin-bottom: 10px;\n  text-align: center;\n  font-size: 20px;\n  color: #888;\n  border-radius: 5px;\n  cursor: pointer;\n}\n\n.active {\n  background-color: #f94b4b;\n  color: white;\n  border-color: #f94b4b;\n}\n</style>"],"mappings":"AAwDA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,OAAA;MACAC,QAAA;MACAC,KAAA;MACAC,KAAA,MAAAC,IAAA;MACAC,SAAA;MACAC,MAAA;MACAC,SAAA;MACAC,OAAA;MACAC,KAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACAC,UAAAC,IAAA;MACA,KAAAN,OAAA,GAAAM,IAAA;IACA;IACAC,YAAAC,IAAA;MACA,KAAAC,QAAA,UACAC,IAAA,CAAAC,CAAA;QACAH,IAAA;MACA,GACAI,KAAA,CAAAD,CAAA,KACA;IACA;IACAR,KAAA;MACA;MACA,KAAAU,QAAA,CAAAC,GAAA,uBAAA3B,IAAA,CAAA4B,EAAA,EAAAL,IAAA,CAAAM,GAAA;QACA,KAAAxB,OAAA,GAAAwB,GAAA,CAAA9B,IAAA;MACA;MACA;MACA,KAAA2B,QAAA,CAAAC,GAAA;QACAG,MAAA;UACAC,MAAA,OAAA/B,IAAA,CAAA4B;QACA;MACA,GAAAL,IAAA,CAAAM,GAAA;QACA,KAAAnB,SAAA,GAAAmB,GAAA,CAAA9B,IAAA;MACA;MACA;MACA,KAAA2B,QAAA,CAAAC,GAAA,+BAAA3B,IAAA,CAAA4B,EAAA,EAAAL,IAAA,CAAAM,GAAA;QACA,KAAAtB,KAAA,GAAAsB,GAAA,CAAA9B,IAAA;MACA;IACA;IACAiC,cAAA;MACA,KAAAN,QAAA,CAAAO,IAAA;QACAF,MAAA,OAAA/B,IAAA,CAAA4B,EAAA;QACAtB,QAAA,OAAAA;MACA,GAAAiB,IAAA,CAAAM,GAAA;QACA,IAAAA,GAAA,CAAAK,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAAV,QAAA,CAAAW,GAAA;YACAT,EAAA,OAAA5B,IAAA,CAAA4B,EAAA;YACAtB,QAAA,OAAAA;UACA,GAAAiB,IAAA,CAAAM,GAAA;YACA,IAAAA,GAAA,CAAAK,IAAA;cACA,KAAAC,QAAA,CAAAC,OAAA;cACA,KAAApB,IAAA;YACA;cACA,KAAAmB,QAAA,CAAAG,KAAA;YACA;UACA;QACA;UACA,KAAAH,QAAA,CAAAG,KAAA,CAAAT,GAAA,CAAAU,GAAA;QACA;MACA;MACA,KAAAvB,IAAA;IACA;IACAwB,UAAA;MACA,KAAAd,QAAA,CAAAW,GAAA;QACAT,EAAA,OAAA5B,IAAA,CAAA4B,EAAA;QACAtB,QAAA,OAAAO;MACA,GAAAU,IAAA,CAAAM,GAAA;QACA,IAAAA,GAAA,CAAAK,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAApB,IAAA;QACA;UACA,KAAAmB,QAAA,CAAAG,KAAA;QACA;MACA;IAEA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}