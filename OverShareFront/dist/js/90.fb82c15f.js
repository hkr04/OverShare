"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[90],{82880:function(t,e,i){i.d(e,{A:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card",staticStyle:{"min-height":"100vh"}},[t._l(t.tableData,(function(i){return t.total>0?e("div",{key:i.id,staticClass:"blog-box"},[e("div",{staticStyle:{flex:"1",width:"0"}},[e("a",{attrs:{href:"/front/blogDetail?blogId="+i.id,target:"_blank"}},[e("div",{staticClass:"blog-box-title"},[t._v(t._s(i.title)+" ")])]),e("div",{staticClass:"line1",staticStyle:{color:"#666","margin-bottom":"10px","font-size":"13px"}},[t._v(" "+t._s(i.descr)+" ")]),e("div",{staticStyle:{display:"flex"}},[e("div",{staticStyle:{flex:"1","font-size":"13px"}},[e("span",{staticStyle:{color:"#666","margin-right":"20px"}},[e("i",{staticClass:"el-icon-user",staticStyle:{"margin-right":"5px"}}),t._v(" "+t._s(i.userName)+" ")]),e("span",{staticStyle:{color:"#666","margin-right":"20px"}},[e("i",{staticClass:"el-icon-eye",staticStyle:{"margin-right":"5px"}}),t._v(" "+t._s(i.readCount)+" ")]),e("span",{staticStyle:{color:"#666"}},[e("i",{staticClass:"el-icon-like",staticStyle:{"margin-right":"5px"}}),t._v(" "+t._s(i.likesCount)+" ")]),t.showOpt?e("span",{staticStyle:{"margin-left":"40px",color:"red",cursor:"pointer"},on:{click:function(e){return t.del(i.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e(),t.showOpt?e("span",{staticStyle:{"margin-left":"10px",color:"#2a60c9",cursor:"pointer"},on:{click:function(e){return t.editBlog(i.id)}}},[e("i",{staticClass:"el-icon-edit"}),t._v("编辑")]):t._e()]),e("div",{staticStyle:{width:"fit-content"}},t._l(JSON.parse(i.tags||[]),(function(i){return e("el-tag",{key:i.id,staticStyle:{"margin-right":"5px"},attrs:{type:"primary"}},[t._v(t._s(i)+" ")])})),1)])]),e("div",[e("div",{staticStyle:{width:"100%"}},[e("img",{staticStyle:{width:"100%",height:"80px","border-radius":"5px"},attrs:{src:i.cover,alt:""}})])])]):t._e()})),0===t.total?e("div",{staticStyle:{padding:"20px","text-align":"center","font-size":"16px",color:"#666"}},[t._v("暂无数据")]):t._e(),t.total?e("div",{staticClass:"pagination",staticStyle:{"margin-top":"10px"}},[e("el-pagination",{attrs:{background:"","current-page":t.pageNum,"page-sizes":[5,10,20],"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1):t._e()],2)},r=[],a={name:"BlogList",props:{categoryName:null,type:null,showOpt:!1},watch:{categoryName(){this.loadBlog(1)}},data(){return{pageNum:1,pageSize:10,tableData:[],total:0,title:this.$route.query.title,userId:this.$route.query.userId}},mounted(){this.loadBlog(1)},methods:{editBlog(t){window.open("/front/newBlog?blogId="+t)},del(t){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/blog/delete/"+t).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.loadBlog(1)):this.$message.error(t.msg)}))})).catch((()=>{}))},loadBlog(t){let e;switch(t&&(this.pageNum=t),this.type){case"user":e="/blog/selectUser";break;case"like":e="/blog/selectLike";break;case"collect":e="/blog/selectCollect";break;case"comment":e="/blog/selectComment";break;case"certification":e="/blog/selectCertification";break;default:e="/blog/selectPage"}this.$request.get(e,{params:{pageNum:this.pageNum,pageSize:this.pageSize,categoryName:"全部作品"===this.categoryName?null:this.categoryName,title:this.title,userId:this.userId}}).then((t=>{this.tableData=t.data?.list,this.total=t.data?.total}))},handleCurrentChange(t){this.loadBlog(t)}}},l=a,o=i(81656),n=(0,o.A)(l,s,r,!1,null,"d388c8d4",null),c=n.exports},52090:function(t,e,i){i.r(e),i.d(e,{default:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{height:"330px","background-color":"#2CBE56"}},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.pageMsg.cover,fit:"cover"}})],1),e("div",{staticClass:"main-content"},[e("div",{staticClass:"card",staticStyle:{padding:"10px",display:"flex","justify-content":"space-between"}},[e("div",{staticStyle:{"margin-right":"15px"}},[t.user.avatar?e("img",{staticClass:"avatar",attrs:{src:t.user.avatar}}):t._e()]),e("div",{staticStyle:{display:"flex","flex-direction":"column","padding-top":"20px"}},[e("span",{staticStyle:{"font-weight":"bold","font-size":"36px"}},[t._v(t._s(t.user.name))]),e("div",{staticStyle:{"font-size":"26px"}},[t._v(" "+t._s(t.user.info)+" ")])]),e("div",{staticStyle:{"margin-left":"auto",display:"flex","align-items":"center"}},[t.isShowConcern?e("div",{staticStyle:{"margin-left":"10px"}},[t.isConcern?e("el-button",{attrs:{round:"",type:"success",size:"medium"},on:{click:t.concern}},[t._v("关注")]):e("el-button",{attrs:{round:"",type:"warning",size:"medium"},on:{click:t.cancelConcern}},[t._v("取消关注")])],1):t._e(),e("div",{staticStyle:{"margin-left":"10px"}},[e("el-statistic",{attrs:{"group-separator":",",value:t.concernCount,title:"关注人数"}})],1)])]),e("div",{staticClass:"card",staticStyle:{"margin-top":"10px"}},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"主页",name:"主页"}},[e("div",{staticStyle:{display:"flex"}},[e("div",{staticStyle:{width:"30%"}},[e("span",{staticStyle:{"font-size":"36px","font-weight":"bold"}},[t._v(t._s(t.memberCount))]),e("div",{staticStyle:{color:"#999999"}},[t._v("会员人数")]),e("el-divider"),e("div",{staticStyle:{"font-size":"20px",padding:"16px"}},[e("div",{domProps:{innerHTML:t._s(t.pageMsg.synopsis)}})])],1),e("div",[e("div",{staticStyle:{"margin-bottom":"5px"}},[t.isShowConcern?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleAdd()}}},[t._v("新增会员档位")])],1),t._l(t.memberList,(function(i){return e("div",{key:i.id},[e("el-card",{staticStyle:{width:"750px",border:"2px solid #8AC007","margin-bottom":"20px"},attrs:{shadow:"always"}},[t.isShowConcern?t._e():e("div",[t.isShowConcern?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleEdit(i.id)}}},[t._v("编辑")]),t.isShowConcern?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.deleteMember(i.id)}}},[t._v("删除")])],1),e("div",{staticStyle:{"font-weight":"bold","font-size":"30px"}},[t._v(t._s(i.title))]),e("div",{staticStyle:{"font-size":"60px","font-weight":"bold","margin-bottom":"10px"}},[t._v(t._s(i.integral)+"积分/月")]),e("div",{staticStyle:{"margin-bottom":"10px","font-size":"16px"}},[e("div",{domProps:{innerHTML:t._s(i.info)}})]),e("div",{staticStyle:{"margin-bottom":"10px"}},[e("span",{staticStyle:{"font-size":"26px","font-weight":"bold"}},[t._v(" 会员福利： "),e("br")]),e("div",[t.isShowConcern?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.editWelfare(i.id)}}},[t._v("设置福利")])],1),e("div",{staticStyle:{color:"#999999"}},[t._v(" "+t._s(i.welfareTitle)+" ")])]),e("div",[i.isOpened?e("el-button",{attrs:{round:"",type:"success",size:"medium"},on:{click:function(e){return t.opened(i.id)}}},[t._v(" 立即开通 ")]):t._e(),i.isOpened?t._e():e("el-button",{attrs:{round:"",type:"primary",size:"medium"}},[t._v(" 已开通 ")])],1)])],1)}))],2)])]),e("el-tab-pane",{attrs:{label:"作品集",name:"作品集"}},[e("BlogList",{attrs:{type:"certification"}})],1)],1)],1)]),e("el-dialog",{attrs:{title:"新增会员档位",visible:t.dialogVisible,width:"60%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticStyle:{"font-weight":"bold","font-size":"24px","margin-bottom":"20px","text-align":"center"}},[t._v("编辑")]),e("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[e("el-form-item",{attrs:{label:"标题",prop:"title"}},[e("el-input",{attrs:{placeholder:"标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("el-form-item",{attrs:{label:"福利标题",prop:"welfareTitle"}},[e("el-input",{attrs:{placeholder:"福利标题"},model:{value:t.form.welfareTitle,callback:function(e){t.$set(t.form,"welfareTitle",e)},expression:"form.welfareTitle"}})],1),e("el-form-item",{attrs:{label:"简介",prop:"info"}},[e("div",{attrs:{id:"editor"}})]),e("el-form-item",{attrs:{label:"需求积分",prop:"integral"}},[e("el-input",{attrs:{placeholder:"需求积分",type:"number"},model:{value:t.form.integral,callback:function(e){t.$set(t.form,"integral",e)},expression:"form.integral"}})],1)],1),e("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)],1)],1)},r=[],a=(i(28743),i(5507)),l=i.n(a),o=i(81109),n=i(66848),c=i(82880),d={name:"HomePage",components:{BlogList:c.A},data(){return{userId:this.$route.query.userId,dbUser:JSON.parse(localStorage.getItem("xm-user")||"{}"),user:{},activeName:"主页",concernCount:0,isShowConcern:!0,isConcern:!1,pageMsg:"",dialogVisible:!1,memberList:[],form:{},editor:null,rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],welfareTitle:[{required:!0,message:"请输入福利标题",trigger:"blur"}],integral:[{required:!0,message:"请输入需求积分",trigger:"blur"}]},welfareTitle:"",memberCount:0}},mounted(){this.load(),this.selectConcernCount(),this.selectIsConcern()},methods:{isOpened(t){return this.$request.get("/myWelfare/selectByMidAndDbUid/"+t+"/"+this.userId+"/"+this.dbUser.id).then((t=>"200"==t.code?null===t.data?1:0:(this.$message.error(t.msg),null)))},opened(t){this.$confirm("是否确定开通此会员?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$request.post("/myWelfare/add",{memberId:t,dbUserId:this.userId}).then((t=>{"200"==t.code?(this.$message.success("开通成功"),this.load()):this.$message.error(t.msg)}))})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},save(){this.$refs.formRef.validate((t=>{t&&(this.form.info=this.editor.txt.html(),this.form.userId=this.userId,this.$request({url:this.form.id?"/member/update":"/member/add",method:this.form.id?"PUT":"POST",data:this.form}).then((t=>{"200"===t.code?(this.$message.success("保存成功"),this.dialogVisible=!1,this.load()):this.$message.error(t.msg)})))}))},handleAdd(){this.form={},this.setRichText(),this.fromVisible=!0,this.dialogVisible=!0},handleEdit(t){this.$request.get("/member/selectByMemberId/"+t).then((t=>{this.form=t.data||{},this.fromVisible=!0,this.dialogVisible=!0,this.setRichText(),setTimeout((()=>{this.editor.txt.html(this.form.info)}),0)}))},deleteMember(t){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/member/delete/"+t).then((t=>{"200"===t.code?(this.$message.success("删除成功"),this.load()):this.$message.error(t.msg)}))})).catch((()=>{}))},setRichText(){this.$nextTick((()=>{this.editor=new(l())("#editor"),this.editor.highlight=o.A,this.editor.config.uploadImgServer=this.$baseUrl+"/files/editor/upload",this.editor.config.uploadFileName="file",this.editor.config.zIndex=0,this.editor.config.uploadImgHeaders={token:this.user.token},this.editor.config.uploadImgParams={type:"img"},this.editor.create()}))},load(){this.$request.get("/user/select/"+this.userId).then((t=>{this.user=t.data||{},this.userId-this.dbUser.id===0&&(this.isShowConcern=!1)})),this.$request.get("homePage/select/"+this.userId).then((t=>{this.pageMsg=t.data||""})),this.$request.get("/member/selectById/"+this.userId).then((t=>{if(this.memberList=t.data||[],0!==this.memberList.length){const t=this.memberList.map((t=>this.isOpened(t.id)));Promise.all(t).then((t=>{t.forEach(((t,e)=>{n["default"].set(this.memberList[e],"isOpened",1===t)}))}))}})),this.$request.get("/myWelfare/selectMemberCount/"+this.userId).then((t=>{this.memberCount=t.data||0}))},handleClose(t){this.$confirm("确认关闭？").then((e=>{t()})).catch((t=>{}))},selectConcernCount(){this.$request.get("concern/selectCount/"+this.userId).then((t=>{this.concernCount=t.data||0}))},selectIsConcern(){this.$request.get("concern/selectIsConcern/"+this.dbUser.id+"/"+this.userId).then((t=>{0!==t.data?this.isConcern=!1:this.isConcern=!0}))},cancelConcern(){this.$request.delete("/concern/delete/"+this.dbUser.id+"/"+this.userId).then((t=>{"200"===t.code?(this.$message.success("取消关注成功"),this.selectConcernCount(),this.selectIsConcern()):this.$message.error(t.msg)}))},concern(){this.$request.post("/concern/add",{userId:this.dbUser.id,creatorId:this.userId}).then((t=>{"200"===t.code?(this.$message.success("关注成功"),this.selectConcernCount(),this.selectIsConcern()):this.$message.error(t.msg)}))},editWelfare(t){this.$router.push("/front/ExitMemberWelfare?userId="+this.userId+"&memberId="+t)}}},h=d,u=i(81656),m=(0,u.A)(h,s,r,!1,null,"aff82084",null),g=m.exports}}]);
//# sourceMappingURL=90.fb82c15f.js.map